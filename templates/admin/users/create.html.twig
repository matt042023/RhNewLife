{% extends 'base.html.twig' %}

{% block title %}Créer un salarié - RH NewLife{% endblock %}

{% block body %}
<div class="min-h-screen bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto">

        {# Header #}
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900">Créer un salarié</h1>
            <p class="text-gray-600 mt-1">Création manuelle pour les cas urgents (remplacements, réembauches)</p>
        </div>

        {# Errors #}
        {% if errors is not empty %}
            <div class="alert alert-error mb-6">
                <ul class="list-disc list-inside">
                    {% for error in errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        {# Form #}
        <form method="post" class="bg-white rounded-2xl shadow-lg p-8">

            {# Informations de base #}
            <div class="mb-8">
                <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    Informations obligatoires
                </h2>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label class="form-label">Prénom *</label>
                        <input type="text" name="first_name" value="{{ formData.first_name ?? '' }}" class="form-input" required>
                    </div>

                    <div>
                        <label class="form-label">Nom *</label>
                        <input type="text" name="last_name" value="{{ formData.last_name ?? '' }}" class="form-input" required>
                    </div>

                    <div class="col-span-2">
                        <label class="form-label">Email *</label>
                        <input type="email" name="email" value="{{ formData.email ?? '' }}" class="form-input" required>
                    </div>

                    <div>
                        <label class="form-label">Poste *</label>
                        <input type="text" name="position" value="{{ formData.position ?? '' }}" class="form-input" required>
                    </div>

                    <div>
                        <label class="form-label">Structure *</label>
                        <select name="structure" class="form-select" required>
                            <option value="">Sélectionner...</option>
                            <option value="Direction" {{ (formData.structure ?? '') == 'Direction' ? 'selected' : '' }}>Direction</option>
                            <option value="Comptabilité" {{ (formData.structure ?? '') == 'Comptabilité' ? 'selected' : '' }}>Comptabilité</option>
                            <option value="RH" {{ (formData.structure ?? '') == 'RH' ? 'selected' : '' }}>RH</option>
                            <option value="Production" {{ (formData.structure ?? '') == 'Production' ? 'selected' : '' }}>Production</option>
                            <option value="Logistique" {{ (formData.structure ?? '') == 'Logistique' ? 'selected' : '' }}>Logistique</option>
                        </select>
                    </div>
                </div>
            </div>

            {# Informations complémentaires #}
            <div class="mb-8">
                <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    Informations complémentaires (optionnel)
                </h2>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label class="form-label">Téléphone</label>
                        <input type="tel" name="phone" value="{{ formData.phone ?? '' }}" class="form-input" placeholder="+33 6 12 34 56 78">
                    </div>

                    <div>
                        <label class="form-label">Date d'embauche</label>
                        <input type="date" name="hiring_date" value="{{ formData.hiring_date ?? '' }}" class="form-input">
                    </div>

                    <div class="col-span-2">
                        <label class="form-label">Adresse</label>
                        <textarea name="address" class="form-input" rows="2">{{ formData.address ?? '' }}</textarea>
                    </div>

                    <div>
                        <label class="form-label">Situation familiale</label>
                        <select name="family_status" class="form-select">
                            <option value="">Non renseigné</option>
                            <option value="single" {{ (formData.family_status ?? '') == 'single' ? 'selected' : '' }}>Célibataire</option>
                            <option value="married" {{ (formData.family_status ?? '') == 'married' ? 'selected' : '' }}>Marié(e)</option>
                            <option value="divorced" {{ (formData.family_status ?? '') == 'divorced' ? 'selected' : '' }}>Divorcé(e)</option>
                            <option value="widowed" {{ (formData.family_status ?? '') == 'widowed' ? 'selected' : '' }}>Veuf(ve)</option>
                        </select>
                    </div>

                    <div>
                        <label class="form-label">Nombre d'enfants</label>
                        <input type="number" name="children" value="{{ formData.children ?? '0' }}" min="0" class="form-input">
                    </div>

                    <div>
                        <label class="form-label">IBAN</label>
                        <input type="text" name="iban" value="{{ formData.iban ?? '' }}" class="form-input" placeholder="FR76 1234 5678 9012 3456 7890 123">
                    </div>

                    <div>
                        <label class="form-label">BIC</label>
                        <input type="text" name="bic" value="{{ formData.bic ?? '' }}" class="form-input" placeholder="BNPAFRPPXXX">
                    </div>
                </div>
            </div>

            {# Options d'invitation #}
            <div class="mb-8">
                <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    Invitation
                </h2>

                <div class="flex items-center gap-3">
                    <input type="checkbox" name="send_invitation" value="1" id="send_invitation" class="w-4 h-4 text-blue-600 rounded" {{ (formData.send_invitation ?? '1') == '1' ? 'checked' : '' }}>
                    <label for="send_invitation" class="text-sm text-gray-700">
                        Envoyer un email d'activation au salarié (lien pour définir son mot de passe)
                    </label>
                </div>
                <p class="text-sm text-gray-500 mt-2 ml-7">
                    Si décoché, le salarié sera créé mais ne recevra pas d'email. Vous pourrez envoyer l'invitation plus tard.
                </p>
            </div>

            {# Actions #}
            <div class="flex items-center justify-between pt-6 border-t">
                <a href="{{ path('app_admin_users_list') }}" class="text-gray-600 hover:text-gray-800 font-semibold">
                    Annuler
                </a>
                <button type="submit" class="btn btn-primary">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Créer le salarié
                </button>
            </div>
        </form>

        {# Info box #}
        <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
            <div class="flex gap-3">
                <svg class="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <div class="text-sm text-blue-800">
                    <p class="font-semibold mb-1">À propos de la création manuelle</p>
                    <p>Le matricule sera généré automatiquement. Le salarié recevra un email avec un lien pour activer son compte sans passer par l'onboarding complet. Il pourra compléter ses informations personnelles et documents plus tard depuis son profil.</p>
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}

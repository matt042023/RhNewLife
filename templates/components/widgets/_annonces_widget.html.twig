{# Widget des annonces internes pour le dashboard #}
{% if annonces|length > 0 %}
<div class="glass-card">
    <div class="p-4 border-b border-white/10">
        <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2">
                <svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"/>
                </svg>
                Annonces
            </h3>
            {% if is_granted('ROLE_ADMIN') %}
                <a href="{{ path('admin_annonce_interne_index') }}" class="text-sm text-emerald-600 hover:text-emerald-700 dark:text-emerald-400 dark:hover:text-emerald-300 font-medium">
                    Voir tout
                </a>
            {% endif %}
        </div>
    </div>

    <div class="divide-y divide-white/10">
        {% for annonce in annonces %}
            <div class="p-4 hover:bg-white/5 transition-colors">
                <div class="flex gap-4">
                    {% if annonce.image %}
                        <div class="flex-shrink-0 hidden sm:block">
                            <img src="{{ asset('uploads/' ~ annonce.image) }}"
                                 alt="{{ annonce.titre }}"
                                 class="w-20 h-16 object-cover rounded-lg">
                        </div>
                    {% endif %}
                    <div class="flex-1 min-w-0">
                        <div class="flex items-start justify-between gap-2">
                            <div>
                                <div class="flex items-center gap-2 flex-wrap">
                                    <h4 class="text-sm font-semibold text-gray-900 dark:text-white truncate">
                                        {{ annonce.titre }}
                                    </h4>
                                    {% if annonce.epingle %}
                                        <span class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-300">
                                            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M5 5a2 2 0 012-2h6a2 2 0 012 2v2H5V5zm0 4h10v6a2 2 0 01-2 2H7a2 2 0 01-2-2V9z"/>
                                            </svg>
                                            Epingle
                                        </span>
                                    {% endif %}
                                </div>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-0.5">
                                    {{ annonce.publiePar.fullName }} - {{ annonce.datePublication|date('d/m/Y') }}
                                </p>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-2 line-clamp-2">
                            {{ annonce.contentPreview(120) }}
                        </p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endif %}
